================================================================================
VDS (VIRTUAL DEDICATED SERVER) KURULUM REHBERÄ°
QR MenÃ¼ & Restoran YÃ¶netim Sistemi
================================================================================

Bu rehber, projenizi kendi VDS sunucunuza kurmak iÃ§in adÄ±m adÄ±m talimatlar iÃ§erir.

================================================================================
Ã–N HAZIRLIK
================================================================================

1. GEREKSINIMLER
   - VDS sunucu (Ubuntu 20.04 veya 22.04 Ã¶nerilen)
   - Root veya sudo yetkisi
   - Domain adÄ± (opsiyonel ama Ã¶nerilen)
   - SSH eriÅŸimi
   - En az 2GB RAM
   - En az 20GB disk alanÄ±

2. SUNUCU Ã–NERÄ°LERÄ°
   TÃ¼rkiye'de popÃ¼ler VDS saÄŸlayÄ±cÄ±lar:
   - DigitalOcean (droplet)
   - Linode
   - Vultr
   - Hetzner
   - Turhost
   - Natro
   
   Ã–nerilen Paket:
   - 2 CPU
   - 2GB RAM
   - 50GB SSD
   - Ubuntu 22.04 LTS
   - AylÄ±k maliyet: ~$10-20

================================================================================
ADIM 1: SUNUCUYA BAÄLANMA
================================================================================

1. SSH ile BaÄŸlan
   
   Windows (PowerShell veya CMD):
   ssh root@SUNUCU_IP_ADRESI
   
   Mac/Linux (Terminal):
   ssh root@SUNUCU_IP_ADRESI
   
   Ã–rnek:
   ssh root@185.123.45.67

2. Åifre Gir
   - VDS saÄŸlayÄ±cÄ±nÄ±zÄ±n verdiÄŸi root ÅŸifresini gir
   - Ä°lk giriÅŸte ÅŸifre deÄŸiÅŸtirmen istenebilir

3. BaÄŸlantÄ± KontrolÃ¼
   - BaÅŸarÄ±lÄ± baÄŸlandÄ±ysan terminal prompt gÃ¶receksin:
   root@server:~#

================================================================================
ADIM 2: SUNUCU GÃœNCELLEME
================================================================================

1. Sistem GÃ¼ncellemesi
   
   apt update
   apt upgrade -y

   Bu iÅŸlem 5-10 dakika sÃ¼rebilir.

2. Gerekli Paketleri Kur
   
   apt install -y curl wget git ufw

3. Firewall AyarlarÄ±
   
   ufw allow OpenSSH
   ufw allow 80/tcp
   ufw allow 443/tcp
   ufw enable
   
   "Command may disrupt existing ssh connections" uyarÄ±sÄ± gelirse 'y' bas.

================================================================================
ADIM 3: NODE.JS KURULUMU
================================================================================

1. Node.js 20.x Kur (LTS)
   
   curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
   apt install -y nodejs

2. Kurulumu Kontrol Et
   
   node --version
   # v20.x.x gÃ¶rmeli
   
   npm --version
   # 10.x.x gÃ¶rmeli

3. PM2 Kur (Process Manager)
   
   npm install -g pm2

================================================================================
ADIM 4: POSTGRESQL KURULUMU (OPSÄ°YONEL)
================================================================================

Supabase kullanÄ±yorsan bu adÄ±mÄ± atla. Kendi database'ini kurmak istiyorsan:

1. PostgreSQL Kur
   
   apt install -y postgresql postgresql-contrib

2. PostgreSQL BaÅŸlat
   
   systemctl start postgresql
   systemctl enable postgresql

3. Database OluÅŸtur
   
   sudo -u postgres psql
   
   PostgreSQL console'da:
   
   CREATE DATABASE qrmenu;
   CREATE USER qrmenu_user WITH PASSWORD 'gÃ¼Ã§lÃ¼_ÅŸifre_buraya';
   GRANT ALL PRIVILEGES ON DATABASE qrmenu TO qrmenu_user;
   \q

NOT: Supabase kullanmanÄ± Ã¶neriyorum, daha kolay ve gÃ¼venli.

================================================================================
ADIM 5: NGINX KURULUMU
================================================================================

1. Nginx Kur
   
   apt install -y nginx

2. Nginx BaÅŸlat
   
   systemctl start nginx
   systemctl enable nginx

3. Test Et
   - TarayÄ±cÄ±da sunucu IP'sine git: http://SUNUCU_IP
   - Nginx welcome sayfasÄ±nÄ± gÃ¶rmelisin

================================================================================
ADIM 6: PROJEYI SUNUCUYA YÃœKLEME
================================================================================

1. Proje KlasÃ¶rÃ¼ OluÅŸtur
   
   mkdir -p /var/www
   cd /var/www

2. GitHub'dan Klonla
   
   # Public repository ise:
   git clone https://github.com/KULLANICI_ADIN/qr-menu-system.git
   
   # Private repository ise Ã¶nce SSH key oluÅŸtur:
   ssh-keygen -t ed25519 -C "sunucu@email.com"
   cat ~/.ssh/id_ed25519.pub
   # Bu key'i GitHub Settings > SSH Keys'e ekle
   # Sonra:
   git clone git@github.com:KULLANICI_ADIN/qr-menu-system.git

3. Proje KlasÃ¶rÃ¼ne Gir
   
   cd qr-menu-system

================================================================================
ADIM 7: ENVIRONMENT VARIABLES AYARLAMA
================================================================================

1. .env.local DosyasÄ± OluÅŸtur
   
   nano .env.local

2. Supabase Bilgilerini Ekle
   
   NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
   NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here

3. Kaydet ve Ã‡Ä±k
   - Ctrl + X
   - Y (Yes)
   - Enter

4. Dosya Ä°zinlerini Ayarla
   
   chmod 600 .env.local

================================================================================
ADIM 8: PROJE KURULUMU
================================================================================

1. Dependencies YÃ¼kle
   
   npm install
   
   Bu iÅŸlem 3-5 dakika sÃ¼rebilir.

2. Production Build
   
   npm run build
   
   Bu iÅŸlem 2-3 dakika sÃ¼rebilir.
   Hata alÄ±rsan:
   - .env.local dosyasÄ±nÄ± kontrol et
   - npm install tekrar Ã§alÄ±ÅŸtÄ±r

3. Build KontrolÃ¼
   
   ls -la .next
   # .next klasÃ¶rÃ¼ oluÅŸmuÅŸ olmalÄ±

================================================================================
ADIM 9: PM2 Ä°LE UYGULAMAYI BAÅLATMA
================================================================================

1. PM2 Ecosystem DosyasÄ± OluÅŸtur
   
   nano ecosystem.config.js

2. AÅŸaÄŸÄ±daki iÃ§eriÄŸi yapÄ±ÅŸtÄ±r:
   
   module.exports = {
     apps: [{
       name: 'qr-menu',
       script: 'npm',
       args: 'start',
       cwd: '/var/www/qr-menu-system',
       instances: 1,
       autorestart: true,
       watch: false,
       max_memory_restart: '1G',
       env: {
         NODE_ENV: 'production',
         PORT: 3000
       }
     }]
   }

3. Kaydet ve Ã‡Ä±k (Ctrl+X, Y, Enter)

4. UygulamayÄ± BaÅŸlat
   
   pm2 start ecosystem.config.js

5. PM2'yi Sistem BaÅŸlangÄ±cÄ±na Ekle
   
   pm2 startup
   # Ã‡Ä±kan komutu kopyala ve Ã§alÄ±ÅŸtÄ±r
   
   pm2 save

6. Durum Kontrol
   
   pm2 status
   # qr-menu online olmalÄ±
   
   pm2 logs qr-menu
   # LoglarÄ± gÃ¶rmek iÃ§in

================================================================================
ADIM 10: NGINX REVERSE PROXY AYARLAMA
================================================================================

1. Nginx Config DosyasÄ± OluÅŸtur
   
   nano /etc/nginx/sites-available/qrmenu

2. AÅŸaÄŸÄ±daki iÃ§eriÄŸi yapÄ±ÅŸtÄ±r:
   
   server {
       listen 80;
       server_name DOMAIN_ADIN_VEYA_IP;

       location / {
           proxy_pass http://localhost:3000;
           proxy_http_version 1.1;
           proxy_set_header Upgrade $http_upgrade;
           proxy_set_header Connection 'upgrade';
           proxy_set_header Host $host;
           proxy_cache_bypass $http_upgrade;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_set_header X-Forwarded-Proto $scheme;
       }
   }

   NOT: DOMAIN_ADIN_VEYA_IP yerine:
   - Domain varsa: qrmenu.com
   - Domain yoksa: 185.123.45.67 (sunucu IP'si)

3. Kaydet ve Ã‡Ä±k (Ctrl+X, Y, Enter)

4. Config'i Aktif Et
   
   ln -s /etc/nginx/sites-available/qrmenu /etc/nginx/sites-enabled/

5. Default Config'i KaldÄ±r
   
   rm /etc/nginx/sites-enabled/default

6. Nginx Test Et
   
   nginx -t
   # "syntax is ok" ve "test is successful" gÃ¶rmeli

7. Nginx'i Yeniden BaÅŸlat
   
   systemctl restart nginx

8. Test Et
   - TarayÄ±cÄ±da: http://SUNUCU_IP veya http://DOMAIN
   - Ana sayfa aÃ§Ä±lmalÄ±

================================================================================
ADIM 11: SSL SERTÄ°FÄ°KASI (HTTPS) - LET'S ENCRYPT
================================================================================

Domain adÄ±n varsa SSL kurmalÄ±sÄ±n (Ã–NEMLÄ°!):

1. Certbot Kur
   
   apt install -y certbot python3-certbot-nginx

2. SSL SertifikasÄ± Al
   
   certbot --nginx -d qrmenu.com -d www.qrmenu.com
   
   NOT: qrmenu.com yerine kendi domain'ini yaz

3. Email Gir
   - Email adresini gir (sertifika yenileme bildirimleri iÃ§in)

4. Terms of Service
   - A (Agree) bas

5. Email Sharing
   - N (No) bas

6. Redirect SeÃ§eneÄŸi
   - 2 seÃ§ (HTTP'yi HTTPS'e yÃ¶nlendir)

7. Test Et
   - TarayÄ±cÄ±da: https://qrmenu.com
   - Kilit simgesi gÃ¶rmelisin

8. Otomatik Yenileme Test Et
   
   certbot renew --dry-run

================================================================================
ADIM 12: DOMAIN DNS AYARLARI
================================================================================

Domain saÄŸlayÄ±cÄ±nda (GoDaddy, Namecheap, vs.):

1. A Record Ekle
   
   Type: A
   Name: @
   Value: SUNUCU_IP_ADRESI
   TTL: 3600

2. WWW CNAME Ekle
   
   Type: CNAME
   Name: www
   Value: qrmenu.com
   TTL: 3600

3. Propagation Bekle
   - DNS deÄŸiÅŸiklikleri 1-24 saat sÃ¼rebilir
   - Genellikle 1-2 saat iÃ§inde aktif olur

4. Test Et
   
   # Terminal'de:
   nslookup qrmenu.com
   # Sunucu IP'sini gÃ¶rmeli

================================================================================
ADIM 13: SUPABASE AYARLARI
================================================================================

1. Supabase Dashboard
   - https://supabase.com/dashboard
   - Projenizi seÃ§

2. Site URL GÃ¼ncelle
   - Authentication > URL Configuration
   - Site URL: https://qrmenu.com
   - Kaydet

3. Redirect URLs Ekle
   - Redirect URLs kÄ±smÄ±na:
   - https://qrmenu.com/**
   - http://SUNUCU_IP/** (test iÃ§in)
   - Kaydet

4. CORS AyarlarÄ±
   - API Settings
   - Allowed origins: https://qrmenu.com
   - Kaydet

================================================================================
ADIM 14: GÃœNCELLEME PROSEDÃœRÃœ
================================================================================

Kod deÄŸiÅŸikliÄŸi yaptÄ±ÄŸÄ±nda:

1. Sunucuya BaÄŸlan
   
   ssh root@SUNUCU_IP

2. Proje KlasÃ¶rÃ¼ne Git
   
   cd /var/www/qr-menu-system

3. Son Kodu Ã‡ek
   
   git pull origin main

4. Dependencies GÃ¼ncelle (gerekirse)
   
   npm install

5. Yeniden Build Et
   
   npm run build

6. PM2'yi Yeniden BaÅŸlat
   
   pm2 restart qr-menu

7. LoglarÄ± Kontrol Et
   
   pm2 logs qr-menu

================================================================================
ADIM 15: BACKUP STRATEJÄ°SÄ°
================================================================================

1. Otomatik Backup Script OluÅŸtur
   
   nano /root/backup.sh

2. Script Ä°Ã§eriÄŸi:
   
   #!/bin/bash
   DATE=$(date +%Y%m%d_%H%M%S)
   BACKUP_DIR="/root/backups"
   PROJECT_DIR="/var/www/qr-menu-system"
   
   mkdir -p $BACKUP_DIR
   
   # Proje backup
   tar -czf $BACKUP_DIR/qrmenu_$DATE.tar.gz $PROJECT_DIR
   
   # Eski backuplarÄ± sil (30 gÃ¼nden eski)
   find $BACKUP_DIR -name "qrmenu_*.tar.gz" -mtime +30 -delete
   
   echo "Backup completed: qrmenu_$DATE.tar.gz"

3. Ã‡alÄ±ÅŸtÄ±rÄ±labilir Yap
   
   chmod +x /root/backup.sh

4. Cron Job Ekle (GÃ¼nlÃ¼k 3:00'da)
   
   crontab -e
   
   En alta ekle:
   0 3 * * * /root/backup.sh >> /var/log/backup.log 2>&1

5. Manuel Backup
   
   /root/backup.sh

================================================================================
ADIM 16: MONÄ°TORÄ°NG VE LOGLAR
================================================================================

1. PM2 Monitoring
   
   pm2 monit
   # CPU, Memory kullanÄ±mÄ±nÄ± gÃ¶sterir
   # Ã‡Ä±kmak iÃ§in: Ctrl+C

2. Uygulama LoglarÄ±
   
   pm2 logs qr-menu
   # Real-time loglar
   
   pm2 logs qr-menu --lines 100
   # Son 100 satÄ±r

3. Nginx LoglarÄ±
   
   # Access log
   tail -f /var/log/nginx/access.log
   
   # Error log
   tail -f /var/log/nginx/error.log

4. Sistem KaynaklarÄ±
   
   # CPU ve Memory
   htop
   
   # Disk kullanÄ±mÄ±
   df -h
   
   # Disk alanÄ± temizle
   apt autoremove -y
   apt clean

================================================================================
ADIM 17: GÃœVENLÄ°K SAÄLAMLAÅTIRMA
================================================================================

1. Yeni Sudo KullanÄ±cÄ± OluÅŸtur (Root yerine)
   
   adduser deploy
   usermod -aG sudo deploy
   
   # Yeni kullanÄ±cÄ± ile giriÅŸ yap:
   ssh deploy@SUNUCU_IP

2. Root SSH GiriÅŸini Kapat
   
   sudo nano /etc/ssh/sshd_config
   
   Bul ve deÄŸiÅŸtir:
   PermitRootLogin no
   
   Kaydet ve SSH'Ä± yeniden baÅŸlat:
   sudo systemctl restart sshd

3. SSH Key Authentication (Åifre yerine)
   
   # Local bilgisayarÄ±nda:
   ssh-keygen -t ed25519
   ssh-copy-id deploy@SUNUCU_IP
   
   # Sunucuda ÅŸifre giriÅŸini kapat:
   sudo nano /etc/ssh/sshd_config
   PasswordAuthentication no
   sudo systemctl restart sshd

4. Fail2Ban Kur (Brute force korumasÄ±)
   
   sudo apt install -y fail2ban
   sudo systemctl enable fail2ban
   sudo systemctl start fail2ban

5. Otomatik GÃ¼venlik GÃ¼ncellemeleri
   
   sudo apt install -y unattended-upgrades
   sudo dpkg-reconfigure -plow unattended-upgrades

================================================================================
ADIM 18: PERFORMANS OPTÄ°MÄ°ZASYONU
================================================================================

1. Nginx Gzip Compression
   
   sudo nano /etc/nginx/nginx.conf
   
   http bloÄŸuna ekle:
   
   gzip on;
   gzip_vary on;
   gzip_min_length 1024;
   gzip_types text/plain text/css text/xml text/javascript 
              application/x-javascript application/xml+rss 
              application/json application/javascript;

2. Nginx Cache
   
   sudo nano /etc/nginx/sites-available/qrmenu
   
   server bloÄŸuna ekle:
   
   location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {
       expires 1y;
       add_header Cache-Control "public, immutable";
   }

3. Nginx'i Yeniden BaÅŸlat
   
   sudo nginx -t
   sudo systemctl restart nginx

4. PM2 Cluster Mode (Ã‡oklu CPU iÃ§in)
   
   nano /var/www/qr-menu-system/ecosystem.config.js
   
   instances: 1 yerine:
   instances: 'max'  # TÃ¼m CPU'larÄ± kullan
   
   pm2 restart qr-menu

================================================================================
ADIM 19: SORUN GÄ°DERME
================================================================================

1. Uygulama AÃ§Ä±lmÄ±yor
   
   # PM2 durumunu kontrol et
   pm2 status
   
   # LoglarÄ± kontrol et
   pm2 logs qr-menu --lines 50
   
   # Yeniden baÅŸlat
   pm2 restart qr-menu

2. 502 Bad Gateway
   
   # Uygulama Ã§alÄ±ÅŸÄ±yor mu?
   pm2 status
   
   # Port 3000 dinleniyor mu?
   netstat -tulpn | grep 3000
   
   # Nginx config test
   sudo nginx -t

3. SSL HatasÄ±
   
   # Sertifika yenile
   sudo certbot renew
   
   # Nginx yeniden baÅŸlat
   sudo systemctl restart nginx

4. YÃ¼ksek Memory KullanÄ±mÄ±
   
   # PM2 restart
   pm2 restart qr-menu
   
   # Memory limit ayarla
   # ecosystem.config.js'de:
   max_memory_restart: '500M'

5. Database BaÄŸlantÄ± HatasÄ±
   
   # .env.local kontrol et
   cat /var/www/qr-menu-system/.env.local
   
   # Supabase eriÅŸilebilir mi?
   curl https://your-project.supabase.co

================================================================================
ADIM 20: PRODUCTION KONTROLÃœ
================================================================================

TÃ¼m Ã¶zellikleri test et:

â–¡ Ana sayfa aÃ§Ä±lÄ±yor (HTTPS)
â–¡ SSL sertifikasÄ± Ã§alÄ±ÅŸÄ±yor (kilit simgesi)
â–¡ Owner giriÅŸi Ã§alÄ±ÅŸÄ±yor
â–¡ Ä°ÅŸletme oluÅŸturma Ã§alÄ±ÅŸÄ±yor
â–¡ QR menÃ¼ aÃ§Ä±lÄ±yor
â–¡ SipariÅŸ oluÅŸturma Ã§alÄ±ÅŸÄ±yor
â–¡ Mutfak ekranÄ± Ã§alÄ±ÅŸÄ±yor
â–¡ Realtime gÃ¼ncellemeler Ã§alÄ±ÅŸÄ±yor
â–¡ Mobil uyumlu
â–¡ HÄ±zlÄ± yÃ¼kleniyor (<3 saniye)

================================================================================
YAPILANDIRMA Ã–ZETÄ°
================================================================================

Sunucu Bilgileri:
- IP: SUNUCU_IP_ADRESI
- Domain: qrmenu.com (varsa)
- OS: Ubuntu 22.04
- Node.js: v20.x
- PM2: Process Manager
- Nginx: Reverse Proxy
- SSL: Let's Encrypt

Proje Konumu:
- /var/www/qr-menu-system

Ã–nemli Komutlar:
- pm2 status              # Uygulama durumu
- pm2 logs qr-menu        # Loglar
- pm2 restart qr-menu     # Yeniden baÅŸlat
- sudo systemctl restart nginx  # Nginx yeniden baÅŸlat
- sudo certbot renew      # SSL yenile

Loglar:
- PM2: pm2 logs qr-menu
- Nginx Access: /var/log/nginx/access.log
- Nginx Error: /var/log/nginx/error.log

Backup:
- Konum: /root/backups/
- Otomatik: Her gÃ¼n 03:00
- Manuel: /root/backup.sh

================================================================================
MALÄ°YET TAHMÄ°NÄ°
================================================================================

AylÄ±k Maliyetler:
- VDS Sunucu: $10-20
- Domain: $10-15/yÄ±l
- SSL: Ãœcretsiz (Let's Encrypt)
- Toplam: ~$10-20/ay

KarÅŸÄ±laÅŸtÄ±rma:
- Vercel: Ãœcretsiz (Hobby) veya $20/ay (Pro)
- VDS: Daha fazla kontrol, daha ucuz bÃ¼yÃ¼k trafik iÃ§in

================================================================================
DESTEK VE KAYNAKLAR
================================================================================

Ubuntu DokÃ¼mantasyon:
- https://ubuntu.com/server/docs

Nginx DokÃ¼mantasyon:
- https://nginx.org/en/docs/

PM2 DokÃ¼mantasyon:
- https://pm2.keymetrics.io/docs/

Let's Encrypt:
- https://letsencrypt.org/docs/

DigitalOcean Tutorials:
- https://www.digitalocean.com/community/tutorials

================================================================================
SONUÃ‡
================================================================================

Tebrikler! Projeniz artÄ±k kendi VDS sunucunuzda Ã§alÄ±ÅŸÄ±yor!

Site URL'niz: https://qrmenu.com (veya http://SUNUCU_IP)

Avantajlar:
âœ“ Tam kontrol
âœ“ Ã–zelleÅŸtirilebilir
âœ“ Maliyet etkin (bÃ¼yÃ¼k trafik iÃ§in)
âœ“ Kendi kurallarÄ±nÄ±z

Dezavantajlar:
âœ— Sunucu yÃ¶netimi gerekli
âœ— GÃ¼venlik sizin sorumluluÄŸunuzda
âœ— Scaling manuel

Sonraki AdÄ±mlar:
1. DÃ¼zenli backup al
2. Monitoring kur
3. GÃ¼venlik gÃ¼ncellemelerini takip et
4. Performance'Ä± optimize et

BaÅŸarÄ±lar! ğŸš€

================================================================================
